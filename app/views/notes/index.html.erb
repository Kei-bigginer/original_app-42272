<!-- ============================== -->
<!-- 🔰 ヘッダー・テーマ表示       -->
<!-- ============================== -->
<h2>今日感じた小さな嬉しいことは？</h2>
<p>例：今日の気づき、今日うれしかったこと、相手に伝えたいこと</p>
<p><strong>今日のテーマ：</strong><%= @theme %></p>

<!-- ============================== -->
<!-- ⚠️ フラッシュメッセージ表示 -->
<!-- ============================== -->
<% if flash[:alert] %>
  <div class="alert alert-warning mt-2">
    <%= flash[:alert] %>
  </div>
<% elsif flash[:notice] %>
  <div class="alert alert-success mt-2">
    <%= flash[:notice] %>
  </div>
<% end %>

<!-- ============================== -->
<!-- 📝 投稿ボタン（モーダル起動） -->
<!-- ============================== -->
<div class="text-end mb-3">
  <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#noteModal">
    ✍️ 今日のひとことを投稿する
  </button>
</div>

<!-- ============================== -->
<!-- 📦 モーダル本体（Bootstrap構造） -->
<!-- ============================== -->
<div class="modal fade" id="noteModal" tabindex="-1" aria-labelledby="noteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      
      <!-- 🧠 モーダルヘッダー -->
      <div class="modal-header">
        <h5 class="modal-title" id="noteModalLabel">今日のひとこと</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="閉じる"></button>
      </div>

      <!-- ✍️ モーダル本文（投稿フォーム） -->
      <div class="modal-body">
        <%= form_with model: @note, local: true do |f| %>
          <div class="form-group">
            <!-- 💬 投稿内容 -->
            <%= f.text_area :content, placeholder: "ここに自由にひとことを書く", rows: 3, maxlength: 140, class: "form-control" %>
          </div>

          <!-- 🎲 ランダムテーマを非表示で送信 -->
          <%= f.hidden_field :theme, value: @theme %>

          <!-- 📨 投稿ボタン -->
          <div class="mt-3">
            <%= f.submit "投稿する", class: "btn btn-success w-100" %>
          </div>
        <% end %>

        <!-- 📌 補足メッセージ -->
        <p class="text-muted small mt-2 mb-0">※投稿は1日1回だけです</p>
      </div>
    </div>
  </div>
</div>

<!-- ============================== -->
<!-- 📃 投稿一覧表示 -->
<!-- ============================== -->
<hr>
<h3>最近のひとこと投稿</h3>

<% if @notes.empty? %>
  <p class="text-muted">まだ投稿がありません。</p>
<% else %>
  <% @notes.each do |note| %>
    <div class="note-card mb-3 p-2 border rounded">
      <!-- 👤 投稿者名 -->
      <p class="mb-1"><strong>👤 <%= note.user.nickname %></strong></p>

      <!-- 💬 テーマ＋本文 -->
      <p class="mb-1">
        💬 <strong><%= note.theme.presence || "テーマ未設定" %></strong>：「<%= note.content %>」
      </p>

      <!-- 📅 投稿日時 -->
      <p class="text-muted small">📅 <%= note.created_at.strftime("%Y年%m月%d日") %></p>
    </div>
  <% end %>
<% end %>
